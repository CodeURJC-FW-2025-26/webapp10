{{>header}}

<div class="row">
    <!-- Sidebar -->
    {{>sidebar}}

    <!-- Content -->
    <div class="col-12 col-lg-10 md-10">
        <main class="content">

            <h1>Editar el videojuego del catálogo</h1>
            <br>

            {{#new_game_from_scratch}}
            <form method="post" id="createGameForm" action="/game/create" novalidate enctype="multipart/form-data"
                class="d-grid">
                {{/new_game_from_scratch}}

                {{^new_game_from_scratch}}
                <form method="post" id="createGameForm" action="/game/create/{{game_id}}" novalidate
                    enctype="multipart/form-data" class="d-grid">
                    {{/new_game_from_scratch}}

                    <!-- Row for the videogame name -->
                    <div class="row mb-4">
                        <label for="title" class="col-sm-3 col-form-label">Nombre del videojuego:</label>
                        <div class="col-sm-9">
                            <input type="text" id="title" name="title" class="form-control"
                                placeholder="Debe comenzar con mayúscula" maxlength="75" value="{{game.title}}"
                                required>
                        </div>
                    </div>

                    <!-- Row for the videogame description -->
                    <div class="row mb-4">
                        <label for="description" class="col-sm-3 col-form-label">Descripción del videojuego:</label>
                        <div class="col-sm-9">
                            <textarea id="description" name="description" class="form-control" rows="4"
                                placeholder="Mínimo de caracteres: 250. Máximo de caracteres: 1500." minlength="250"
                                maxlength="1500" required>{{game.description}}</textarea>
                        </div>
                    </div>

                    <!-- Row for the videogame short description -->
                    <div class="row mb-4">
                        <label for="short_description" class="col-sm-3 col-form-label">Descripción corta del
                            videojuego:</label>
                        <div class="col-sm-9">
                            <textarea id="short_description" name="short_description" class="form-control" rows="3"
                                placeholder="Mínimo de caracteres: 100. Máximo de caracteres: 500." minlength="100"
                                maxlength="500" required>{{game.short_description}}</textarea>
                        </div>
                    </div>

                    <!-- Row for the videogame developer -->
                    <div class="row mb-4">
                        <label for="developer" class="col-sm-3 col-form-label">Desarrollador del videojuego:</label>
                        <div class="col-sm-9">
                            <input type="text" id="developer" name="developer" class="form-control"
                                placeholder="Desarrollador" value="{{game.developer}}" maxlength="50" required>
                        </div>
                    </div>

                    <!-- Row for the videogame editor -->
                    <div class="row mb-4">
                        <label for="editor" class="col-sm-3 col-form-label">Editor del videojuego:</label>
                        <div class="col-sm-9">
                            <input type="text" id="editor" name="editor" class="form-control" placeholder="Editor"
                                value="{{game.editor}}" maxlength="50" required>
                        </div>
                    </div>

                    <!-- Row for the videogame image -->
                    <div class="row mb-4">
                        <label for="imageFilename" class="col-sm-3 col-form-label">Imagen del videojuego:</label>
                        <div class="col-sm-9">
                            <input type="file" id="imageFilename" name="imageFilename" class="form-control"
                                accept="image/*">
                            <span>Archivo actual: <img src="/game/{{game._id}}/image" width="300" height="300"> </span>
                        </div>
                    </div>

                    <!-- Row for the videogame cost -->
                    <div class="row mb-4">
                        <label for="price" class="col-sm-3 col-form-label">Coste del videojuego:</label>
                        <div class="col-sm-3">
                            <input type="number" id="price" name="price" min="0" max="1000" step="0.01"
                                class="form-control" placeholder="Coste en €" value="{{game.price}}" required>
                        </div>
                        <label for="price" class="col-sm-1 col-form-label">€</label>
                    </div>

                    <!-- Row for the videogame release date -->
                    <div class="row mb-4">
                        <label for="release_date" class="col-sm-3 col-form-label">Fecha de lanzamiento del
                            videojuego:</label>
                        <div class="col-sm-3">
                            <input type="date" id="release_date" name="release_date" class="form-control"
                                value="{{game.release_date}}" required>
                        </div>
                    </div>

                    <!-- Row for the videogame platforms -->
                    <div class="row mb-4">
                        <label for="platforms" class="col-sm-3 col-form-label">Plataformas en las que se encuentra
                            disponible el videojuego:</label>
                        <div id="platforms" class="col-sm-9">
                            {{#platforms}}
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="platform_{{value}}"
                                    name="platform[]" value="{{value}}" {{#checked}}checked{{/checked}}>
                                <label class="form-check-label" for="platform_{{value}}">{{display}}</label>
                            </div>
                            {{/platforms}}
                        </div>
                    </div>

                    <!-- Row for the videogame modes -->
                    <div class="row mb-4">
                        <label for="modes" class="col-sm-3 col-form-label">Modos de juego disponibles:</label>
                        <div id="modes" class="col-sm-9">
                            {{#gamemods}}
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="gamemod_{{value}}" name="gamemod[]"
                                    value="{{value}}" {{#checked}}checked{{/checked}}>
                                <label class="form-check-label" for="gamemod_{{value}}">{{display}}</label>
                            </div>
                            {{/gamemods}}
                        </div>
                    </div>

                    <!-- Row for the age classification -->
                    <div class="row mb-4">
                        <label for="age_classification" class="col-sm-3 col-form-label">Clasificación PEGI por
                            edades:</label>
                        <select id="age_classification" name="age_classification" class="form-select col-sm-9" required>
                            <option value="{{game.age_classification}}" selected>{{game.age_classification}}</option>
                            <option value="3">3</option>
                            <option value="7">7</option>
                            <option value="12">12</option>
                            <option value="16">16</option>
                            <option value="18">18</option>
                        </select>
                    </div>

                    <!-- Row for the videogame rating -->
                    <div class="row mb-4">
                        <label for="rating" class="col-sm-3 col-form-label">Calificación del videojuego:</label>
                        <div class="col-sm-4">
                            <input type="number" id="rating" name="rating" class="form-control" min="0" max="5"
                                step="0.5" placeholder="Calificación de 0 a 5" value="{{game.rating}}" required>
                        </div>
                    </div>

                    <!-- Row for the videogame genres -->
                    <div class="row mb-4">
                        <label for="genres" class="col-sm-3 col-form-label">Género/s principal/es del
                            videojuego:</label>
                        <div id="genres" class="col-sm-9">
                            {{#genres}}
                            <div class="form-check">
                                <input class="form-check-input" type="checkbox" id="genre_{{value}}" name="genre[]"
                                    value="{{value}}" {{#checked}}checked{{/checked}}>
                                <label class="form-check-label" for="genre_{{value}}">{{display}}</label>
                            </div>
                            {{/genres}}
                        </div>
                    </div>

                    <!-- Row for the "buttons" -->
                    <div class="row mb-4" id="form_buttons">
                        <!-- "Button" to cancel the form and return to the main page IF they are creating a new one -->
                        {{#new_game_from_scratch}}
                        <a href="/" class="btn col-sm-3">
                            <h1><i class="bi bi-house-fill"></i> </h1> <!-- House icon -->
                            Cancelar
                        </a>
                        {{/new_game_from_scratch}}

                        <!-- "Button" to cancel the form and return to the videogame page IF they are editing an existing one -->
                        {{^new_game_from_scratch}}
                        <a href="/game/{{game_id}}" class="btn col-sm-3">
                            <h1><i class="bi bi-house-fill"></i> </h1> <!-- House icon -->
                            Cancelar
                        </a>
                        {{/new_game_from_scratch}}

                        <!-- "Button" to complete the form and submit the data -->
                        <!-- role to make it work like a button. tabindex for keyboard navigation. aria-label for accessibility. onclick to submit the form and onkeydown to do the same but with keyboard tiles "Enter" and "Space". -->
                        <div class="btn col-sm-3" role="button" tabindex="0"
                            aria-label="Completar formulario del Videojuego"
                            onclick="(function(f){ if(f.requestSubmit) f.requestSubmit(); else f.submit(); })(this.closest('form')); return false;"
                            onkeydown="if(event.key==='Enter'||event.key===' '){ event.preventDefault(); (function(f){ if(f.requestSubmit) f.requestSubmit(); else f.submit(); })(this.closest('form')); }">
                            <h1><i class="bi bi-file-plus"></i></h1>
                            Completar formulario del Videojuego
                        </div>
                    </div>
                </form>
        </main>
    </div>
</div>

<!-- Footer -->
{{>footer}}