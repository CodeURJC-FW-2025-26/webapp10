<!DOCTYPE html>
<html>

<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>{{title}}</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="/MoreForPlaying.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400..900&display=swap" rel="stylesheet">
    <link href="//cdn.jsdelivr.net/npm/bootstrap-icons@1.10.0/font/bootstrap-icons.css" rel="stylesheet">
</head>

<body>
    <div class="container-fluid">
        <div class="row">
            <!-- Header -->
            <div class="col-12 mb-3"> <!-- Takes the full width and the bottom margin is 3 -->
                <header class="header flex-column flex-md-row">
                    {{>header}}
                </header>
            </div>
        </div>


        <div class="row">
            <!-- Sidebar -->
            <div class="col-lg-2 md-2 mb-3">
                <aside class="sidebar">
                    {{>sidebar}}
                </aside>
            </div>


            <div class="col-12 col-lg-10 md-10">

                <main class="game-p-content">
                    <!--content-->
                        <!-- Game title and action buttons -->
                    <div class="row d-flex flex-column flex-md-row">
    
                        <div class="title col-6"> {{title}}
                            <div class="rating-stars">
                                <!-- Full stars -->
                                {{#stars.starFull}}
                                <i class="bi bi-star-fill text-danger"></i>
                                {{/stars.starFull}}

                                <!-- Half stars -->
                                {{#stars.starHalf}}
                                <i class="bi bi-star-half text-danger"></i>
                                {{/stars.starHalf}}

                                <!-- Empty stars -->
                                {{#stars.starEmpty}}
                                <i class="bi bi-star text-danger"></i>
                                {{/stars.starEmpty}}
                            </div>
                        </div>
                        <div class="edit-button col-6 mb-3 d-flex flex-column flex-md-row gap-2">
                                <form onsubmit="securemessage(event)" action="/game/{{_id}}/delete"> 
                                    <input type="submit" class="btn btn-primary" value="Borrar juego"></form>
                                    
                                <a href="/editgame/{{_id}}" class="btn btn-primary">Editar juego</a>
                                <a href="/creategame" class="btn btn-primary"><i class="bi bi-pencil-square"></i>
                                    Crear tu propio juego</a>
                                <a href="/" class="btn btn-primary">Volver a página principal</a>
                        </div>
                    </div>

                    <div class="row">

                        <div class="p-information d-flex flex-column flex-md-row">
                            <!-- Game short description -->
                            <div class="p-description col-12 col-md-9 "> {{short_description}}
                            </div>
                            <!-- Game /images -->
                            <div class="image-side col-12 col-md-3">
                                <img src="/image?filename={{imageFilename}}" alt="Portada de {{title}}">
                            </div>

                        </div>

                        <div class="row">

                            <div class="information col-12">    
                                <!-- Game price -->
                                <div id="price" class="description"> Precio: {{price}} €
                                
                                </div>
                                <!-- Detailed game description -->
                                <div id="description" class="description">
                                    <h2>Descripción</h2>

                                    <p>{{description}}</p>
                                </div>
                                <!-- Game information table -->
                                <div id="information" class="description">
                                    <h2>Información</h2>
                                    <table class="table-unstyled overflow-x-auto">
                                        <tr>
                                            <th>Desarrollador</th>
                                            <td>{{developer}}</td>
                                        </tr>
                                        <tr>
                                            <th>Editor</th>
                                            <td>{{editor}}</td>
                                        </tr>
                                        <tr>
                                            <th>Fecha de lanzamiento</th>
                                            <td>{{release_date}}</td>
                                        </tr>
                                        <tr>
                                            <th>Plataformas disponibles</th>
                                            <td>
                                                {{#platform}}
                                                    <span>{{.}}</span>
                                                {{/platform}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Modos de juego</th>
                                            <td>
                                                {{#gamemod}}
                                                    <span>{{.}}</span>
                                                {{/gamemod}}
                                            </td>
                                        </tr>
                                        <tr>
                                            <th>Clasificación por edades</th>
                                            <td>PEGI {{age_classification}}</td>
                                        </tr>
                                        
                                        <tr>
                                            <th>Género/s</th>
                                            <td>
                                                {{#genre}}
                                                    <span>{{.}}</span>
                                                {{/genre}}
                                            </td>
                                        </tr>
                                    </table>
                                </div>
                                <!-- User reviews section -->
                                <div id="reseñas" class="description overflow-x-auto">
                                     
                                    <h2>Reseñas de usuarios</h2>
                                    <!-- Individual user review with rating and /images -->
                                  
                                    {{#reviews}}
                                        <div class="game-title"><h4>{{date}}-{{username}}:<i class="bi bi-person-check-fill text-info"></i></div>
                                        
                                        <div class="rating-stars">
                                            <!-- Full stars -->
                                            {{#stars.starFull}}
                                            <i class="bi bi-star-fill text-danger"></i>
                                            {{/stars.starFull}}

                                            <!-- Half stars -->
                                            {{#stars.starHalf}}
                                            <i class="bi bi-star-half text-danger"></i>
                                            {{/stars.starHalf}}

                                            <!-- Empty stars -->
                                            {{#stars.starEmpty}}
                                            <i class="bi bi-star text-danger"></i>
                                            {{/stars.starEmpty}}
                                        </div></h4>
                                        <p>{{comment}} </p>
                                        <!-- Review image -->
                                        <div>
                                            <img src="/game/{{game_id}}/review/{{_id}}/image" width="300" height="200">
                                        </div>
                                        <!-- Edit and delete buttons for the review -->
                                        <div class="m-3 justify-content-start d-flex">
                                            <form  action="/game/{{game_id}}/review/delete" method="POST" >
                                                <input type="hidden" name="review_id" value="{{_id}}">
                                                <input type="submit" class="btn btn-primary" value="Borrar">
                                                <a href="/game/{{game_id}}/review_editor/{{_id}}" class="btn" >Editar</a>
                                            </form>
                                            
                                        </div>
                                        
                                    {{/reviews}}

                                </div>
                                <!-- Add new review form -->
                                <div id="add_reseñas" class="description col-12 col-lg-12 md-12">
                                    <h2>Añadir Reseña</h2>
                                    <br>

                                    <form onsubmit="" action="/game/{{_id}}/review/create" method="POST" enctype="multipart/form-data" class="d-grid ">
                                        <!-- Row for the user name -->
                                        <div class="row mb-4">
                                            <label for="user_name" class="col-sm-3 col-form-label">Nombre de usuario:</label>
                                            <div class="col-sm-9">
                                                <input type="text" name="user_name" class="form-control" maxlength="50" placeholder="Nombre" required>
                                            </div>
                                        </div>

                                        <!-- Row for the comment -->
                                        <div class="row mb-4">
                                            <label for="comment_description" class="col-sm-3 col-form-label">Introduzca aquí su comentario:</label>
                                            <div class="col-sm-9">
                                                <textarea name="comment_description" class="form-control" rows="4" placeholder="Descripción" minlength="25" maxlength="200" required></textarea>
                                            </div>
                                        </div>

                                        <!-- Row for the videogame rating -->
                                        <div class="row mb-4">
                                            <label for="rating" class="col-sm-3 col-form-label">Calificación:</label>
                                            <div class="col-sm-5">
                                                <input type="number" name="rating" class="form-control" min="0" max="5" step="0.5" placeholder="Calificación de 0 a 5" required>
                                            </div>
                                        </div> 
                                        
                                        <!-- Row for the videogame photos -->
                                        <div class="row mb-4">
                                            <label for="imageFilename" class="col-sm-3 col-form-label">Imagen del videojuego:</label>
                                            <div class="col-sm-9">
                                                <input type="file" id="imageFilename" name="imageFilename" class="form-control" accept="image/*" required>
                                            </div>
                                        </div>

                                        <div class="row mb-4 " >
                                            <!-- "Button" to finish the comment and submit the data -->
                                            <input type="submit" value="Subir reseña" class="btn btn-primary">
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </main>
            </div>
        </div>
        <div class="row">
            <!-- Footer -->
            <div class="col-12">
                <footer class="footer">
                    {{>footer}}
                </footer>
            </div>
        </div>
    </div>


    <script src="/app.js"></script>
</body>

</html>
